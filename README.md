# PDFtoTXT

PDFファイルの指定ページからテキストを抽出する CLI ツール

## 概要

このツールは、PDFファイルとページ番号を引数に取り、そのページに記載されているテキストを抽出してテキストファイルとして出力します。

## 機能

- 指定されたPDFファイルの特定ページからテキストを抽出
- 抽出したテキストを `<元PDF名>-<ページ番号>.txt` 形式で保存
- 日本語を含む実行結果のログ出力
- 詳細なエラーメッセージとエラーハンドリング

## 必要環境

- Python 3.10 以上（Python 3.12 で動作確認済み）
- pip（パッケージ管理ツール）

## セットアップ

### 1. リポジトリのクローン

```bash
git clone https://github.com/fujinetyo/PDFtoTXT.git
cd PDFtoTXT
```

### 2. 仮想環境の作成（推奨）

```bash
python -m venv .venv
```

### 3. 仮想環境の有効化

**macOS / Linux の場合:**

```bash
source .venv/bin/activate
```

**Windows の場合:**

```bash
.venv\Scripts\activate
```

### 4. 依存関係のインストール

```bash
pip install -r requirements.txt
```

## 使い方

### 基本的な使用方法

```bash
python pdf_page_text.py --pdf <PDFファイルパス> --page <ページ番号>
```

### 使用例

#### 例1: カレントディレクトリのPDFファイルから3ページ目を抽出

```bash
python pdf_page_text.py --pdf ./sample.pdf --page 3
```

**期待される出力:**

```
INFO: テキスト抽出を開始します...
INFO: PDF総ページ数: 10
INFO: /path/to/sample.pdf の 3 ページ目を解析中...
INFO: 出力ファイル: /path/to/current/dir/sample-3.txt
INFO: 正常終了
```

#### 例2: 別のディレクトリにあるPDFファイルから1ページ目を抽出

```bash
python pdf_page_text.py --pdf /path/to/documents/report.pdf --page 1
```

#### 例3: ヘルプの表示

```bash
python pdf_page_text.py --help
```

### 引数の説明

| 引数 | 必須 | 説明 |
|------|------|------|
| `--pdf <PDFファイルパス>` | ✓ | 抽出元のPDFファイルのパス（相対パスまたは絶対パス） |
| `--page <ページ番号>` | ✓ | 抽出するページ番号（1始まり） |

## 出力

- **出力先:** 実行したカレントディレクトリ
- **ファイル名形式:** `<元のPDFファイル名>-<ページ番号>.txt`
  - 例: `sample.pdf` の 3 ページ目 → `sample-3.txt`
  - 例: `report.pdf` の 12 ページ目 → `report-12.txt`

## エラーハンドリング

このツールは以下のエラーを検出し、適切なメッセージを日本語で出力します：

### エラーの種類と対処法

| エラー | 原因 | 対処法 |
|--------|------|--------|
| `PDFファイルが見つかりません` | 指定されたファイルが存在しない | ファイルパスを確認してください |
| `ページ番号が範囲外です` | 指定されたページ番号がPDFの範囲外 | 1からPDFの総ページ数の範囲内で指定してください |
| `ファイルへのアクセス権限がありません` | ファイルの読み込み/書き込み権限がない | ファイルの権限を確認してください |
| `pypdf ライブラリがインストールされていません` | 依存ライブラリが未インストール | `pip install -r requirements.txt` を実行してください |

### エラー時の動作

- エラー発生時は非0の終了コードで終了します
- エラーメッセージは標準エラー出力に日本語で出力されます

## 制限事項

1. **レイアウトの保持:** テキストのレイアウト（段組み、表形式など）は保持されません
2. **画像内のテキスト:** 画像として埋め込まれたテキスト（OCRが必要なもの）は抽出できません
3. **暗号化されたPDF:** パスワード保護されたPDFには対応していません
4. **フォント:** 特殊なフォントや埋め込まれていないフォントの場合、正しく抽出できない可能性があります
5. **改行・空白:** 元のPDFの改行や空白は適宜変換されます

## 依存ライブラリ

- **pypdf** (>=4.0.0): PDFファイルからのテキスト抽出

詳細は `requirements.txt` を参照してください。

## 動作確認環境

- macOS（推奨）
- Linux（推奨）
- Windows（基本的に動作するはずですが、パスの扱いに注意が必要）

## トラブルシューティング

### pypdf がインストールできない

```bash
pip install --upgrade pip
pip install -r requirements.txt
```

### 仮想環境が有効化されない

仮想環境のパスが正しいか確認してください。また、Pythonのバージョンが3.10以上であることを確認してください。

```bash
python --version
```

### 出力ファイルが見つからない

出力ファイルはツールを実行したカレントディレクトリに作成されます。実行時のカレントディレクトリを確認してください。

```bash
pwd  # カレントディレクトリを表示
ls -la *.txt  # 生成されたテキストファイルを確認
```

## ライセンス

このプロジェクトのライセンスについては、リポジトリのライセンスファイルを参照してください。

## 貢献

バグ報告や機能リクエストは GitHub の Issues でお願いします。
